#cloud-config
users:
  - name: root
    ssh_authorized_keys:
      - ${ssh_public_key}
  - name: beamup
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    ssh_authorized_keys:
      - ${ssh_public_key}

# Enable SSH password authentication temporarily for initial setup
ssh_pwauth: true

# Update package cache on first boot
package_update: true
package_upgrade: false

# Install basic packages
packages:
  - openssh-server
  - curl
  - wget
  - ca-certificates
  - gnupg
  - lsb-release

# Enable SSH service
runcmd:
  - systemctl enable ssh
  - systemctl start ssh
  - echo 'PermitRootLogin yes' >> /etc/ssh/sshd_config
  - systemctl reload ssh

# Set timezone
timezone: UTC

# Configure network (ensure interface comes up)
network:
  version: 2
  ethernets:
    enp1s0:
      dhcp4: true